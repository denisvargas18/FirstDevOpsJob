language: java
jdk:
 - openjdk11
#mono: none
sudo: required #or false
os: linux
dist: xenial # distribution linux ubuntu
branches:
  only:
    - main
    #- develop
    #except:
    #- uat
    #- feature
#before_script:
#env: #required upload files coverage //to psssed configure variable into job console
#  global:
#    - CODECOV_TOKEN=:a63810c9-ed26-4f57-908b-5cd35f128622
cache:
  directories:
    - $HOME/.m2
before_script:
  - chmod -R a+x devops
before_install:
  - chmod +x mvnw
script:
  - ./devops/compile.sh
  - ./devops/test.sh
  - ./devops/report.sh
after_success:
  - bash <(curl -s https://codecov.io/bash)
  - ./devops/build.sh
# [START travis_deploy]
deploy:
    provider: gae
    # Skip cleanup so api_key.py and vendored dependencies are still there
    skip_cleanup: true
    keyfile: ms-firstdevopsjob-java-7c551a585d7d.json #Name file keypair generated in gcp
    project: ms-firstdevopsjob-java #name project ID into GCP created
    version: service-demo
    default: true
    on:
      all_branches: true
notifications:
  email:
    on_success: always
    on_failure: always
# [END travis_deploy]